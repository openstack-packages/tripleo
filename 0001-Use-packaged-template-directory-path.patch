From df341d4667ccfa0c52574a69888476132f6e125c Mon Sep 17 00:00:00 2001
From: Javier Pena <jpena@redhat.com>
Date: Thu, 28 May 2015 12:28:00 +0200
Subject: [PATCH] Use packaged template directory

---
 scripts/configure-vm  | 5 +----
 scripts/setup-network | 6 ++++--
 2 files changed, 5 insertions(+), 6 deletions(-)

diff --git a/scripts/configure-vm b/scripts/configure-vm
index 690a682..e482f93 100755
--- a/scripts/configure-vm
+++ b/scripts/configure-vm
@@ -6,10 +6,7 @@ import random
 
 import libvirt
 
-templatedir = os.path.join(
-                os.path.dirname(
-                  os.path.dirname(
-                    os.path.abspath(__file__))), 'templates')
+templatedir="/usr/share/tripleo/templates"
 
 def generate_bm_mac_address():
     """Generate an Ethernet MAC address suitable for baremetal testing."""
diff --git a/scripts/setup-network b/scripts/setup-network
index fd66980..34948a7 100755
--- a/scripts/setup-network
+++ b/scripts/setup-network
@@ -1,5 +1,7 @@
 #!/bin/bash
-set -eu
+set -eux
+
+template_dir="/usr/share/tripleo/templates"
 
 BASE=$(dirname $0)/../
 BRIDGE_SUFFIX=${1:-''} # support positional arg for legacy support
@@ -46,7 +48,7 @@ function create_bridge {
     (virsh net-list --persistent | grep "${BRIDGE_NAME} ") && virsh net-destroy ${BRIDGE_NAME}
     (virsh net-list --inactive --persistent | grep "${BRIDGE_NAME} ") && virsh net-undefine ${BRIDGE_NAME}
 
-    virsh net-define <(sed s/%NETWORK_NAME%/$BRIDGE_NAME/ $BASE/templates/net.xml)
+    virsh net-define <(sed s/%NETWORK_NAME%/$BRIDGE_NAME/ $template_dir/net.xml)
     virsh net-autostart ${BRIDGE_NAME}
     virsh net-start ${BRIDGE_NAME}
 
-- 
2.1.0

